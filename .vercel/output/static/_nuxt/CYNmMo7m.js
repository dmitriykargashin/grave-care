import{_ as K}from"./0HdooiPx.js";import{_ as M}from"./BKIbx5OH.js";import{d as H,a5 as O,I as b,r as B,x,B as e,N as m,C as t,_ as v,J as a,R as L,O as k,V as g,$ as z,y as o,D as n,M as r,P as C,z as d,L as G,A as u,Z as T,K as V,Q,S as W,T as X,U as Y,W as Z,X as j}from"./DSoo6jVJ.js";import{u as A,a as q,V as w}from"./BxkK-uK3.js";import{V as ee}from"./CJj81yv5.js";import{V as I}from"./BNw2KUzE.js";import"./CDhTuRGa.js";import"./D9WYUSSA.js";const te={class:"text-h5"},se={class:"text-body-1"},ae={class:"text-body-1"},oe={class:"text-body-1"},le={style:{"white-space":"pre-wrap"}},ve=H({__name:"[id]",async setup(ne){let c,p;const y=O().params.id,{data:i,pending:R,refresh:$}=([c,p]=b(()=>A(`/api/customers/${y}`,"$SKoGDFB1HU")),c=await c,p(),c),{data:D,pending:U,refresh:h}=([c,p]=b(()=>A(`/api/customers/${y}/graves`,"$a2cwbMtRJY")),c=await c,p(),c),f=B(!1),_=B(!1);function F(N){return new Date(N).toLocaleDateString()}function E(){f.value=!0}function S(){_.value=!0}return(N,s)=>{const P=K,J=M;return o(),x("div",null,[e(v,{variant:"text",class:"mb-4",to:"/customers"},{default:t(()=>[e(r,{icon:"mdi-arrow-left",start:""}),s[2]||(s[2]=n(" Back to Customers ",-1))]),_:1}),a(R)?(o(),m(I,{key:0,type:"article"})):a(i)?(o(),x(L,{key:1},[e(g,{class:"mb-4"},{default:t(()=>[e(C,{class:"d-flex align-center"},{default:t(()=>[e(G,{color:"primary",class:"mr-3"},{default:t(()=>[e(r,{icon:"mdi-account"})]),_:1}),d("span",te,u(a(i).fullName),1),e(T),e(v,{icon:"",variant:"text",onClick:E},{default:t(()=>[e(r,{icon:"mdi-pencil"})]),_:1})]),_:1}),e(V,null,{default:t(()=>[e(q,null,{default:t(()=>[a(i).phone?(o(),m(w,{key:0,cols:"12",sm:"6",md:"4"},{default:t(()=>[s[3]||(s[3]=d("div",{class:"text-caption text-medium-emphasis"},"Phone",-1)),d("div",se,[e(r,{icon:"mdi-phone",size:"small",class:"mr-1"}),n(" "+u(a(i).phone),1)])]),_:1})):k("",!0),a(i).email?(o(),m(w,{key:1,cols:"12",sm:"6",md:"4"},{default:t(()=>[s[4]||(s[4]=d("div",{class:"text-caption text-medium-emphasis"},"Email",-1)),d("div",ae,[e(r,{icon:"mdi-email",size:"small",class:"mr-1"}),n(" "+u(a(i).email),1)])]),_:1})):k("",!0),e(w,{cols:"12",sm:"6",md:"4"},{default:t(()=>[s[5]||(s[5]=d("div",{class:"text-caption text-medium-emphasis"},"Customer Since",-1)),d("div",oe,u(F(a(i).createdAt)),1)]),_:1})]),_:1})]),_:1})]),_:1}),a(i).notes?(o(),m(g,{key:0,class:"mb-4"},{default:t(()=>[e(C,null,{default:t(()=>[e(r,{icon:"mdi-note-text",class:"mr-2"}),s[6]||(s[6]=n(" Notes ",-1))]),_:1}),e(V,null,{default:t(()=>[d("p",le,u(a(i).notes),1)]),_:1})]),_:1})):k("",!0),e(g,null,{default:t(()=>[e(C,{class:"d-flex align-center"},{default:t(()=>[e(r,{icon:"mdi-grave-stone",class:"mr-2"}),s[8]||(s[8]=n(" Graves ",-1)),e(T),e(v,{color:"primary",size:"small",onClick:S},{default:t(()=>[e(r,{icon:"mdi-plus",start:""}),s[7]||(s[7]=n(" New Grave ",-1))]),_:1})]),_:1}),a(U)?(o(),m(V,{key:0},{default:t(()=>[e(I,{type:"list-item-two-line@3"})]),_:1})):a(D)?.length?(o(),m(Q,{key:1},{default:t(()=>[(o(!0),x(L,null,W(a(D),l=>(o(),m(X,{key:l.id,to:`/graves/${l.id}`},{prepend:t(()=>[e(G,{color:"secondary",size:"40"},{default:t(()=>[e(r,{icon:"mdi-grave-stone"})]),_:1})]),append:t(()=>[e(j,{color:l.openTasksCount>0?"warning":"success",size:"small",class:"mr-2"},{default:t(()=>[n(u(l.openTasksCount)+" tasks ",1)]),_:2},1032,["color"]),e(r,{icon:"mdi-chevron-right"})]),default:t(()=>[e(Y,null,{default:t(()=>[n(u(l.deceasedName||"Unknown"),1)]),_:2},1024),e(Z,null,{default:t(()=>[n(u(l.cemeteryName)+" Â· "+u(l.plotRef),1)]),_:2},1024)]),_:2},1032,["to"]))),128))]),_:1})):(o(),m(V,{key:2,class:"text-center text-medium-emphasis py-8"},{default:t(()=>[e(r,{icon:"mdi-grave-stone",size:"48",class:"mb-2"}),s[10]||(s[10]=d("div",null,"No graves for this customer",-1)),e(v,{color:"primary",variant:"tonal",class:"mt-4",onClick:S},{default:t(()=>[...s[9]||(s[9]=[n(" Add First Grave ",-1)])]),_:1})]),_:1}))]),_:1})],64)):(o(),m(ee,{key:2,type:"error",variant:"tonal"},{default:t(()=>[...s[11]||(s[11]=[n(" Customer not found ",-1)])]),_:1})),e(P,{modelValue:a(f),"onUpdate:modelValue":s[0]||(s[0]=l=>z(f)?f.value=l:null),customer:a(i),onSaved:a($)},null,8,["modelValue","customer","onSaved"]),e(J,{modelValue:a(_),"onUpdate:modelValue":s[1]||(s[1]=l=>z(_)?_.value=l:null),"prefill-customer-id":a(y),onSaved:a(h)},null,8,["modelValue","prefill-customer-id","onSaved"])])}}});export{ve as default};
