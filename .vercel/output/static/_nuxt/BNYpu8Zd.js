import{_ as M}from"./iZecZUG0.js";import{_ as j}from"./CKqc3zdB.js";import{d as q,aq as H,ao as b,r as B,x,B as e,W as d,C as t,J as v,_ as a,N as z,X as k,P as g,ar as K,Z as G,y as o,D as n,M as r,aj as C,z as m,Q as L,A as u,$ as A,ak as y,V as O,I as w,ap as I,a5 as Q,O as W,a6 as X,a7 as Y,a9 as Z,a0 as ee}from"./CqnZqnHT.js";import{u as T}from"./CPSzfpNf.js";const te={class:"text-h5"},se={class:"text-body-1"},ae={class:"text-body-1"},oe={class:"text-body-1"},le={style:{"white-space":"pre-wrap"}},ce=q({__name:"[id]",async setup(ne){let c,p;const V=H().params.id,{data:i,pending:$,refresh:R}=([c,p]=b(()=>T(`/api/customers/${V}`,"$SKoGDFB1HU")),c=await c,p(),c),{data:D,pending:h,refresh:F}=([c,p]=b(()=>T(`/api/customers/${V}/graves`,"$a2cwbMtRJY")),c=await c,p(),c),f=B(!1),_=B(!1);function U(S){return new Date(S).toLocaleDateString()}function E(){f.value=!0}function N(){_.value=!0}return(S,s)=>{const P=M,J=j;return o(),x("div",null,[e(v,{variant:"text",class:"mb-4",to:"/customers"},{default:t(()=>[e(r,{icon:"mdi-arrow-left",start:""}),s[2]||(s[2]=n(" Back to Customers ",-1))]),_:1}),a($)?(o(),d(I,{key:0,type:"article"})):a(i)?(o(),x(z,{key:1},[e(g,{class:"mb-4"},{default:t(()=>[e(C,{class:"d-flex align-center"},{default:t(()=>[e(L,{color:"primary",class:"mr-3"},{default:t(()=>[e(r,{icon:"mdi-account"})]),_:1}),m("span",te,u(a(i).fullName),1),e(A),e(v,{icon:"",variant:"text",onClick:E},{default:t(()=>[e(r,{icon:"mdi-pencil"})]),_:1})]),_:1}),e(y,null,{default:t(()=>[e(O,null,{default:t(()=>[a(i).phone?(o(),d(w,{key:0,cols:"12",sm:"6",md:"4"},{default:t(()=>[s[3]||(s[3]=m("div",{class:"text-caption text-medium-emphasis"},"Phone",-1)),m("div",se,[e(r,{icon:"mdi-phone",size:"small",class:"mr-1"}),n(" "+u(a(i).phone),1)])]),_:1})):k("",!0),a(i).email?(o(),d(w,{key:1,cols:"12",sm:"6",md:"4"},{default:t(()=>[s[4]||(s[4]=m("div",{class:"text-caption text-medium-emphasis"},"Email",-1)),m("div",ae,[e(r,{icon:"mdi-email",size:"small",class:"mr-1"}),n(" "+u(a(i).email),1)])]),_:1})):k("",!0),e(w,{cols:"12",sm:"6",md:"4"},{default:t(()=>[s[5]||(s[5]=m("div",{class:"text-caption text-medium-emphasis"},"Customer Since",-1)),m("div",oe,u(U(a(i).createdAt)),1)]),_:1})]),_:1})]),_:1})]),_:1}),a(i).notes?(o(),d(g,{key:0,class:"mb-4"},{default:t(()=>[e(C,null,{default:t(()=>[e(r,{icon:"mdi-note-text",class:"mr-2"}),s[6]||(s[6]=n(" Notes ",-1))]),_:1}),e(y,null,{default:t(()=>[m("p",le,u(a(i).notes),1)]),_:1})]),_:1})):k("",!0),e(g,null,{default:t(()=>[e(C,{class:"d-flex align-center"},{default:t(()=>[e(r,{icon:"mdi-grave-stone",class:"mr-2"}),s[8]||(s[8]=n(" Graves ",-1)),e(A),e(v,{color:"primary",size:"small",onClick:N},{default:t(()=>[e(r,{icon:"mdi-plus",start:""}),s[7]||(s[7]=n(" New Grave ",-1))]),_:1})]),_:1}),a(h)?(o(),d(y,{key:0},{default:t(()=>[e(I,{type:"list-item-two-line@3"})]),_:1})):a(D)?.length?(o(),d(Q,{key:1},{default:t(()=>[(o(!0),x(z,null,W(a(D),l=>(o(),d(X,{key:l.id,to:`/graves/${l.id}`},{prepend:t(()=>[e(L,{color:"secondary",size:"40"},{default:t(()=>[e(r,{icon:"mdi-grave-stone"})]),_:1})]),append:t(()=>[e(ee,{color:l.openTasksCount>0?"warning":"success",size:"small",class:"mr-2"},{default:t(()=>[n(u(l.openTasksCount)+" tasks ",1)]),_:2},1032,["color"]),e(r,{icon:"mdi-chevron-right"})]),default:t(()=>[e(Y,null,{default:t(()=>[n(u(l.deceasedName||"Unknown"),1)]),_:2},1024),e(Z,null,{default:t(()=>[n(u(l.cemeteryName)+" Â· "+u(l.plotRef),1)]),_:2},1024)]),_:2},1032,["to"]))),128))]),_:1})):(o(),d(y,{key:2,class:"text-center text-medium-emphasis py-8"},{default:t(()=>[e(r,{icon:"mdi-grave-stone",size:"48",class:"mb-2"}),s[10]||(s[10]=m("div",null,"No graves for this customer",-1)),e(v,{color:"primary",variant:"tonal",class:"mt-4",onClick:N},{default:t(()=>[...s[9]||(s[9]=[n(" Add First Grave ",-1)])]),_:1})]),_:1}))]),_:1})],64)):(o(),d(K,{key:2,type:"error",variant:"tonal"},{default:t(()=>[...s[11]||(s[11]=[n(" Customer not found ",-1)])]),_:1})),e(P,{modelValue:a(f),"onUpdate:modelValue":s[0]||(s[0]=l=>G(f)?f.value=l:null),customer:a(i),onSaved:a(R)},null,8,["modelValue","customer","onSaved"]),e(J,{modelValue:a(_),"onUpdate:modelValue":s[1]||(s[1]=l=>G(_)?_.value=l:null),"prefill-customer-id":a(V),onSaved:a(F)},null,8,["modelValue","prefill-customer-id","onSaved"])])}}});export{ce as default};
