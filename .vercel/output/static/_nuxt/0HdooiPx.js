import{d as S,a0 as y,a1 as T,r as i,k as M,a2 as U,N as h,C as u,a3 as B,y as D,B as a,P as F,D as f,M as E,J as o,A as b,K as P,a4 as $,Y as j,Z as q,_ as x,V as A,G as I}from"./DSoo6jVJ.js";import{b as O,c,d as R}from"./BxkK-uK3.js";const G=S({__name:"CustomerDialog",props:y({customer:{}},{modelValue:{type:Boolean,default:!1},modelModifiers:{}}),emits:y(["saved"],["update:modelValue"]),setup(p,{emit:w}){const r=p,_=w,m=T(p,"modelValue"),V=i(),d=i(!1),n=M(()=>!!r.customer?.id),t=i({fullName:"",phone:"",email:"",notes:""}),v=I("showSnackbar");U(()=>r.customer,s=>{s?t.value={fullName:s.fullName,phone:s.phone||"",email:s.email||"",notes:s.notes||""}:C()},{immediate:!0});function C(){t.value={fullName:"",phone:"",email:"",notes:""}}function N(){m.value=!1,C()}async function g(){const{valid:s}=await V.value.validate();if(s){d.value=!0;try{const e=n.value?`/api/customers/${r.customer.id}`:"/api/customers",l=n.value?"PUT":"POST",k=await $fetch(e,{method:l,body:t.value});_("saved",k),v?.(`Customer ${n.value?"updated":"created"} successfully`),N()}catch(e){console.error("Error saving customer:",e),v?.("Failed to save customer","error")}finally{d.value=!1}}}return(s,e)=>(D(),h(B,{modelValue:m.value,"onUpdate:modelValue":e[4]||(e[4]=l=>m.value=l),"max-width":"500",persistent:""},{default:u(()=>[a(A,null,{default:u(()=>[a(F,{class:"d-flex align-center"},{default:u(()=>[a(E,{icon:o(n)?"mdi-pencil":"mdi-plus",class:"mr-2"},null,8,["icon"]),f(" "+b(o(n)?"Edit Customer":"New Customer"),1)]),_:1}),a(P,null,{default:u(()=>[a(O,{ref_key:"formRef",ref:V,onSubmit:$(g,["prevent"])},{default:u(()=>[a(c,{modelValue:o(t).fullName,"onUpdate:modelValue":e[0]||(e[0]=l=>o(t).fullName=l),label:"Full Name",rules:[l=>!!l||"Name is required"],required:""},null,8,["modelValue","rules"]),a(c,{modelValue:o(t).phone,"onUpdate:modelValue":e[1]||(e[1]=l=>o(t).phone=l),label:"Phone",type:"tel"},null,8,["modelValue"]),a(c,{modelValue:o(t).email,"onUpdate:modelValue":e[2]||(e[2]=l=>o(t).email=l),label:"Email",type:"email",rules:[l=>!l||/.+@.+\..+/.test(l)||"Invalid email"]},null,8,["modelValue","rules"]),a(R,{modelValue:o(t).notes,"onUpdate:modelValue":e[3]||(e[3]=l=>o(t).notes=l),label:"Notes",rows:"3"},null,8,["modelValue"])]),_:1},512)]),_:1}),a(j,null,{default:u(()=>[a(q),a(x,{variant:"text",onClick:N},{default:u(()=>[...e[5]||(e[5]=[f("Cancel",-1)])]),_:1}),a(x,{color:"primary",loading:o(d),onClick:g},{default:u(()=>[f(b(o(n)?"Save":"Create"),1)]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),Y=Object.assign(G,{__name:"CustomerDialog"});export{Y as _};
