import{_ as q}from"./BKIbx5OH.js";import{d as z,r as c,k as S,I as $,x as P,B as e,C as t,V as C,J as o,$ as T,y as b,K as U,_ as p,D as f,M as d,q as E,z as u,N as F,O as I,A as v,a4 as K,X as M}from"./DSoo6jVJ.js";import{u as O,a as X,V as x,c as j}from"./BxkK-uK3.js";import{V as J}from"./BLiBMJ1o.js";import"./CDhTuRGa.js";import"./D9WYUSSA.js";const Z={class:"font-weight-medium"},H={class:"text-center py-8"},L={class:"text-body-2 text-medium-emphasis mb-4"},oe=z({__name:"index",async setup(Q){let i,g;const l=c(""),N=S(()=>{const n={};return l.value&&(n.q=l.value),n}),{data:w,pending:h,refresh:y}=([i,g]=$(()=>O("/api/graves",{query:N},"$KksAP6ZX7w")),i=await i,g(),i),r=c(!1),m=c(null),D=[{title:"Deceased Name",key:"deceasedName",sortable:!0},{title:"Cemetery",key:"cemeteryName",sortable:!0},{title:"Plot Ref",key:"plotRef",sortable:!0},{title:"Customer",key:"customerName",sortable:!0},{title:"Open Tasks",key:"openTasksCount",sortable:!0},{title:"",key:"actions",sortable:!1,width:50}];let _;function B(){clearTimeout(_),_=setTimeout(()=>y(),300)}function k(){m.value=null,r.value=!0}function A(n){m.value=n,r.value=!0}function G(){y()}return(n,a)=>{const R=q;return b(),P("div",null,[e(C,{class:"mb-4"},{default:t(()=>[e(U,null,{default:t(()=>[e(X,{align:"center"},{default:t(()=>[e(x,{cols:"12",sm:"6",md:"4"},{default:t(()=>[e(j,{modelValue:o(l),"onUpdate:modelValue":[a[0]||(a[0]=s=>T(l)?l.value=s:null),B],"prepend-inner-icon":"mdi-magnify",label:"Search graves...","hide-details":"",clearable:""},null,8,["modelValue"])]),_:1}),e(x,{cols:"12",sm:"6",md:"8",class:"text-right"},{default:t(()=>[e(p,{color:"primary",onClick:k},{default:t(()=>[e(d,{icon:"mdi-plus",start:""}),a[3]||(a[3]=f(" New Grave ",-1))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(C,null,{default:t(()=>[e(J,{headers:D,items:o(w)||[],loading:o(h),"items-per-page":15,hover:"","onClick:row":a[1]||(a[1]=(s,{item:V})=>("navigateTo"in n?n.navigateTo:o(E))(`/graves/${V.id}`))},{"item.deceasedName":t(({item:s})=>[u("span",Z,v(s.deceasedName||"Unknown"),1)]),"item.openTasksCount":t(({item:s})=>[e(M,{color:s.openTasksCount>0?"warning":"success",size:"small"},{default:t(()=>[f(v(s.openTasksCount),1)]),_:2},1032,["color"])]),"item.actions":t(({item:s})=>[e(p,{icon:"",variant:"text",size:"small",onClick:K(V=>A(s),["stop"])},{default:t(()=>[e(d,{icon:"mdi-pencil"})]),_:1},8,["onClick"])]),"no-data":t(()=>[u("div",H,[e(d,{icon:"mdi-grave-stone",size:"64",color:"grey-lighten-1"}),a[5]||(a[5]=u("div",{class:"text-h6 mt-4"},"No graves found",-1)),u("div",L,v(o(l)?"Try adjusting your search":"Add your first grave to get started"),1),o(l)?I("",!0):(b(),F(p,{key:0,color:"primary",onClick:k},{default:t(()=>[e(d,{icon:"mdi-plus",start:""}),a[4]||(a[4]=f(" Add Grave ",-1))]),_:1}))])]),_:1},8,["items","loading"])]),_:1}),e(R,{modelValue:o(r),"onUpdate:modelValue":a[2]||(a[2]=s=>T(r)?r.value=s:null),grave:o(m),onSaved:G},null,8,["modelValue","grave"])])}}});export{oe as default};
