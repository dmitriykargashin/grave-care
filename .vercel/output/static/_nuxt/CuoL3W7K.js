import{_ as q}from"./CKqc3zdB.js";import{d as z,r as c,k as P,ao as S,x as U,B as e,C as a,P as V,_ as o,Z as T,y as b,ak as $,V as E,I as x,Y as F,J as p,D as v,M as d,aw as I,q as M,z as u,W as X,X as Z,A as f,am as j,a0 as J}from"./CqnZqnHT.js";import{u as K}from"./CPSzfpNf.js";const O={class:"font-weight-medium"},W={class:"text-center py-8"},Y={class:"text-body-2 text-medium-emphasis mb-4"},ae=z({__name:"index",async setup(H){let i,g;const l=c(""),w=P(()=>{const n={};return l.value&&(n.q=l.value),n}),{data:N,pending:h,refresh:k}=([i,g]=S(()=>K("/api/graves",{query:w},"$KksAP6ZX7w")),i=await i,g(),i),r=c(!1),m=c(null),D=[{title:"Deceased Name",key:"deceasedName",sortable:!0},{title:"Cemetery",key:"cemeteryName",sortable:!0},{title:"Plot Ref",key:"plotRef",sortable:!0},{title:"Customer",key:"customerName",sortable:!0},{title:"Open Tasks",key:"openTasksCount",sortable:!0},{title:"",key:"actions",sortable:!1,width:50}];let y;function B(){clearTimeout(y),y=setTimeout(()=>k(),300)}function _(){m.value=null,r.value=!0}function A(n){m.value=n,r.value=!0}function G(){k()}return(n,t)=>{const R=q;return b(),U("div",null,[e(V,{class:"mb-4"},{default:a(()=>[e($,null,{default:a(()=>[e(E,{align:"center"},{default:a(()=>[e(x,{cols:"12",sm:"6",md:"4"},{default:a(()=>[e(F,{modelValue:o(l),"onUpdate:modelValue":[t[0]||(t[0]=s=>T(l)?l.value=s:null),B],"prepend-inner-icon":"mdi-magnify",label:"Search graves...","hide-details":"",clearable:""},null,8,["modelValue"])]),_:1}),e(x,{cols:"12",sm:"6",md:"8",class:"text-right"},{default:a(()=>[e(p,{color:"primary",onClick:_},{default:a(()=>[e(d,{icon:"mdi-plus",start:""}),t[3]||(t[3]=v(" New Grave ",-1))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(V,null,{default:a(()=>[e(I,{headers:D,items:o(N)||[],loading:o(h),"items-per-page":15,hover:"","onClick:row":t[1]||(t[1]=(s,{item:C})=>("navigateTo"in n?n.navigateTo:o(M))(`/graves/${C.id}`))},{"item.deceasedName":a(({item:s})=>[u("span",O,f(s.deceasedName||"Unknown"),1)]),"item.openTasksCount":a(({item:s})=>[e(J,{color:s.openTasksCount>0?"warning":"success",size:"small"},{default:a(()=>[v(f(s.openTasksCount),1)]),_:2},1032,["color"])]),"item.actions":a(({item:s})=>[e(p,{icon:"",variant:"text",size:"small",onClick:j(C=>A(s),["stop"])},{default:a(()=>[e(d,{icon:"mdi-pencil"})]),_:1},8,["onClick"])]),"no-data":a(()=>[u("div",W,[e(d,{icon:"mdi-grave-stone",size:"64",color:"grey-lighten-1"}),t[5]||(t[5]=u("div",{class:"text-h6 mt-4"},"No graves found",-1)),u("div",Y,f(o(l)?"Try adjusting your search":"Add your first grave to get started"),1),o(l)?Z("",!0):(b(),X(p,{key:0,color:"primary",onClick:_},{default:a(()=>[e(d,{icon:"mdi-plus",start:""}),t[4]||(t[4]=v(" Add Grave ",-1))]),_:1}))])]),_:1},8,["items","loading"])]),_:1}),e(R,{modelValue:o(r),"onUpdate:modelValue":t[2]||(t[2]=s=>T(r)?r.value=s:null),grave:o(m),onSaved:G},null,8,["modelValue","grave"])])}}});export{ae as default};
