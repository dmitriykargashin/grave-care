import{_ as q}from"./BKIbx5OH.js";import{_ as H,T as I,a as Y}from"./TP-IniU1.js";import{d as ee,a5 as te,I as b,r as N,x as y,B as e,N as p,C as t,_ as V,J as s,R as L,O as A,V as x,$ as R,y as i,D as o,M as d,P as k,z as m,A as n,Z as B,K as f,X as S,Q as $,T as z,U as E,W as F,L as ae,S as se}from"./DSoo6jVJ.js";import{u as P,a as le,V as C}from"./BxkK-uK3.js";import{V as oe}from"./CJj81yv5.js";import{V as U}from"./BNw2KUzE.js";import"./CDhTuRGa.js";import"./D9WYUSSA.js";const re={class:"text-h5"},ne={class:"text-body-1"},ie={class:"text-body-1"},de={class:"text-body-1"},ue={style:{"white-space":"pre-wrap"}},me={key:0},Ce=ee({__name:"[id]",async setup(ce){let c,_;const T=te().params.id,{data:r,pending:G,refresh:O}=([c,_]=b(()=>P(`/api/graves/${T}`,"$s0NDsyafW0")),c=await c,_(),c),{data:w,pending:K,refresh:M}=([c,_]=b(()=>P(`/api/graves/${T}/tasks`,"$CEQmfAL1MO")),c=await c,_(),c),v=N(!1),g=N(!1);function Q(u){return I.find(a=>a.value===u)?.color||"grey"}function W(u){return I.find(a=>a.value===u)?.title||u}function h(u){return Y.find(a=>a.value===u)?.color||"grey"}function J(u){return u?new Date(u).toLocaleDateString():"-"}function X(){v.value=!0}function D(){g.value=!0}return(u,a)=>{const Z=q,j=H;return i(),y("div",null,[e(V,{variant:"text",class:"mb-4",to:"/graves"},{default:t(()=>[e(d,{icon:"mdi-arrow-left",start:""}),a[2]||(a[2]=o(" Back to Graves ",-1))]),_:1}),s(G)?(i(),p(U,{key:0,type:"article"})):s(r)?(i(),y(L,{key:1},[e(x,{class:"mb-4"},{default:t(()=>[e(k,{class:"d-flex align-center"},{default:t(()=>[e(d,{icon:"mdi-grave-stone",class:"mr-2"}),m("span",re,n(s(r).deceasedName||"Unknown Deceased"),1),e(B),e(V,{icon:"",variant:"text",onClick:X},{default:t(()=>[e(d,{icon:"mdi-pencil"})]),_:1})]),_:1}),e(f,null,{default:t(()=>[e(le,null,{default:t(()=>[e(C,{cols:"12",sm:"6",md:"3"},{default:t(()=>[a[3]||(a[3]=m("div",{class:"text-caption text-medium-emphasis"},"Cemetery",-1)),m("div",ne,n(s(r).cemeteryName),1)]),_:1}),e(C,{cols:"12",sm:"6",md:"3"},{default:t(()=>[a[4]||(a[4]=m("div",{class:"text-caption text-medium-emphasis"},"Plot Reference",-1)),m("div",ie,n(s(r).plotRef),1)]),_:1}),e(C,{cols:"12",sm:"6",md:"3"},{default:t(()=>[a[5]||(a[5]=m("div",{class:"text-caption text-medium-emphasis"},"Customer",-1)),m("div",de,n(s(r).customerName),1)]),_:1}),e(C,{cols:"12",sm:"6",md:"3"},{default:t(()=>[a[6]||(a[6]=m("div",{class:"text-caption text-medium-emphasis"},"Open Tasks",-1)),e(S,{color:s(r).openTasksCount>0?"warning":"success",size:"small"},{default:t(()=>[o(n(s(r).openTasksCount),1)]),_:1},8,["color"])]),_:1})]),_:1})]),_:1})]),_:1}),s(r).specialInstructions?(i(),p(x,{key:0,class:"mb-4"},{default:t(()=>[e(k,null,{default:t(()=>[e(d,{icon:"mdi-information",class:"mr-2"}),a[7]||(a[7]=o(" Special Instructions ",-1))]),_:1}),e(f,null,{default:t(()=>[m("p",ue,n(s(r).specialInstructions),1)]),_:1})]),_:1})):A("",!0),e(x,{class:"mb-4"},{default:t(()=>[e(k,null,{default:t(()=>[e(d,{icon:"mdi-account-circle",class:"mr-2"}),a[8]||(a[8]=o(" Customer Details ",-1))]),_:1}),e(f,null,{default:t(()=>[e($,null,{default:t(()=>[e(z,{to:`/customers/${s(r).customerId}`},{prepend:t(()=>[e(ae,{color:"primary"},{default:t(()=>[e(d,{icon:"mdi-account"})]),_:1})]),append:t(()=>[e(d,{icon:"mdi-chevron-right"})]),default:t(()=>[e(E,null,{default:t(()=>[o(n(s(r).customerName),1)]),_:1}),e(F,null,{default:t(()=>[...a[9]||(a[9]=[o("Click to view customer details",-1)])]),_:1})]),_:1},8,["to"])]),_:1})]),_:1})]),_:1}),e(x,null,{default:t(()=>[e(k,{class:"d-flex align-center"},{default:t(()=>[e(d,{icon:"mdi-clipboard-check",class:"mr-2"}),a[11]||(a[11]=o(" Tasks ",-1)),e(B),e(V,{color:"primary",size:"small",onClick:D},{default:t(()=>[e(d,{icon:"mdi-plus",start:""}),a[10]||(a[10]=o(" New Task ",-1))]),_:1})]),_:1}),s(K)?(i(),p(f,{key:0},{default:t(()=>[e(U,{type:"list-item-two-line@3"})]),_:1})):s(w)?.length?(i(),p($,{key:1},{default:t(()=>[(i(!0),y(L,null,se(s(w),l=>(i(),p(z,{key:l.id,to:`/tasks/${l.id}`},{prepend:t(()=>[e(S,{color:Q(l.status),size:"small",class:"mr-2"},{default:t(()=>[o(n(W(l.status)),1)]),_:2},1032,["color"])]),append:t(()=>[e(S,{color:h(l.priority),size:"x-small",variant:"outlined",class:"mr-2"},{default:t(()=>[o(n(l.priority),1)]),_:2},1032,["color"]),e(d,{icon:"mdi-chevron-right"})]),default:t(()=>[e(E,null,{default:t(()=>[o(n(l.title),1)]),_:2},1024),e(F,null,{default:t(()=>[o(n(l.type.replace("_"," "))+" ",1),l.scheduledFor?(i(),y("span",me," Â· "+n(J(l.scheduledFor)),1)):A("",!0)]),_:2},1024)]),_:2},1032,["to"]))),128))]),_:1})):(i(),p(f,{key:2,class:"text-center text-medium-emphasis py-8"},{default:t(()=>[e(d,{icon:"mdi-clipboard-text-outline",size:"48",class:"mb-2"}),a[13]||(a[13]=m("div",null,"No tasks for this grave",-1)),e(V,{color:"primary",variant:"tonal",class:"mt-4",onClick:D},{default:t(()=>[...a[12]||(a[12]=[o(" Create First Task ",-1)])]),_:1})]),_:1}))]),_:1})],64)):(i(),p(oe,{key:2,type:"error",variant:"tonal"},{default:t(()=>[...a[14]||(a[14]=[o(" Grave not found ",-1)])]),_:1})),e(Z,{modelValue:s(v),"onUpdate:modelValue":a[0]||(a[0]=l=>R(v)?v.value=l:null),grave:s(r),onSaved:s(O)},null,8,["modelValue","grave","onSaved"]),e(j,{modelValue:s(g),"onUpdate:modelValue":a[1]||(a[1]=l=>R(g)?g.value=l:null),"prefill-grave-id":s(T),onSaved:s(M)},null,8,["modelValue","prefill-grave-id","onSaved"])])}}});export{Ce as default};
