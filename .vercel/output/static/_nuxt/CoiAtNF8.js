import{_ as Z}from"./CKqc3zdB.js";import{_ as H,T as I,a as Y}from"./DHKPLmpm.js";import{d as ee,aq as te,ao as b,r as N,x as y,B as e,W as p,C as t,J as x,_ as s,N as L,X as A,P as k,ar as ae,Z as B,y as i,D as o,M as d,aj as V,z as m,A as r,$ as R,ak as f,V as se,I as C,a0 as S,a5 as $,a6 as z,a7 as E,a9 as F,Q as le,ap as P,O as oe}from"./CqnZqnHT.js";import{u as G}from"./CPSzfpNf.js";const ne={class:"text-h5"},re={class:"text-body-1"},ie={class:"text-body-1"},de={class:"text-body-1"},ue={style:{"white-space":"pre-wrap"}},me={key:0},ye=ee({__name:"[id]",async setup(ce){let c,_;const T=te().params.id,{data:n,pending:O,refresh:U}=([c,_]=b(()=>G(`/api/graves/${T}`,"$s0NDsyafW0")),c=await c,_(),c),{data:w,pending:K,refresh:M}=([c,_]=b(()=>G(`/api/graves/${T}/tasks`,"$CEQmfAL1MO")),c=await c,_(),c),v=N(!1),g=N(!1);function Q(u){return I.find(a=>a.value===u)?.color||"grey"}function W(u){return I.find(a=>a.value===u)?.title||u}function h(u){return Y.find(a=>a.value===u)?.color||"grey"}function j(u){return u?new Date(u).toLocaleDateString():"-"}function q(){v.value=!0}function D(){g.value=!0}return(u,a)=>{const J=Z,X=H;return i(),y("div",null,[e(x,{variant:"text",class:"mb-4",to:"/graves"},{default:t(()=>[e(d,{icon:"mdi-arrow-left",start:""}),a[2]||(a[2]=o(" Back to Graves ",-1))]),_:1}),s(O)?(i(),p(P,{key:0,type:"article"})):s(n)?(i(),y(L,{key:1},[e(k,{class:"mb-4"},{default:t(()=>[e(V,{class:"d-flex align-center"},{default:t(()=>[e(d,{icon:"mdi-grave-stone",class:"mr-2"}),m("span",ne,r(s(n).deceasedName||"Unknown Deceased"),1),e(R),e(x,{icon:"",variant:"text",onClick:q},{default:t(()=>[e(d,{icon:"mdi-pencil"})]),_:1})]),_:1}),e(f,null,{default:t(()=>[e(se,null,{default:t(()=>[e(C,{cols:"12",sm:"6",md:"3"},{default:t(()=>[a[3]||(a[3]=m("div",{class:"text-caption text-medium-emphasis"},"Cemetery",-1)),m("div",re,r(s(n).cemeteryName),1)]),_:1}),e(C,{cols:"12",sm:"6",md:"3"},{default:t(()=>[a[4]||(a[4]=m("div",{class:"text-caption text-medium-emphasis"},"Plot Reference",-1)),m("div",ie,r(s(n).plotRef),1)]),_:1}),e(C,{cols:"12",sm:"6",md:"3"},{default:t(()=>[a[5]||(a[5]=m("div",{class:"text-caption text-medium-emphasis"},"Customer",-1)),m("div",de,r(s(n).customerName),1)]),_:1}),e(C,{cols:"12",sm:"6",md:"3"},{default:t(()=>[a[6]||(a[6]=m("div",{class:"text-caption text-medium-emphasis"},"Open Tasks",-1)),e(S,{color:s(n).openTasksCount>0?"warning":"success",size:"small"},{default:t(()=>[o(r(s(n).openTasksCount),1)]),_:1},8,["color"])]),_:1})]),_:1})]),_:1})]),_:1}),s(n).specialInstructions?(i(),p(k,{key:0,class:"mb-4"},{default:t(()=>[e(V,null,{default:t(()=>[e(d,{icon:"mdi-information",class:"mr-2"}),a[7]||(a[7]=o(" Special Instructions ",-1))]),_:1}),e(f,null,{default:t(()=>[m("p",ue,r(s(n).specialInstructions),1)]),_:1})]),_:1})):A("",!0),e(k,{class:"mb-4"},{default:t(()=>[e(V,null,{default:t(()=>[e(d,{icon:"mdi-account-circle",class:"mr-2"}),a[8]||(a[8]=o(" Customer Details ",-1))]),_:1}),e(f,null,{default:t(()=>[e($,null,{default:t(()=>[e(z,{to:`/customers/${s(n).customerId}`},{prepend:t(()=>[e(le,{color:"primary"},{default:t(()=>[e(d,{icon:"mdi-account"})]),_:1})]),append:t(()=>[e(d,{icon:"mdi-chevron-right"})]),default:t(()=>[e(E,null,{default:t(()=>[o(r(s(n).customerName),1)]),_:1}),e(F,null,{default:t(()=>[...a[9]||(a[9]=[o("Click to view customer details",-1)])]),_:1})]),_:1},8,["to"])]),_:1})]),_:1})]),_:1}),e(k,null,{default:t(()=>[e(V,{class:"d-flex align-center"},{default:t(()=>[e(d,{icon:"mdi-clipboard-check",class:"mr-2"}),a[11]||(a[11]=o(" Tasks ",-1)),e(R),e(x,{color:"primary",size:"small",onClick:D},{default:t(()=>[e(d,{icon:"mdi-plus",start:""}),a[10]||(a[10]=o(" New Task ",-1))]),_:1})]),_:1}),s(K)?(i(),p(f,{key:0},{default:t(()=>[e(P,{type:"list-item-two-line@3"})]),_:1})):s(w)?.length?(i(),p($,{key:1},{default:t(()=>[(i(!0),y(L,null,oe(s(w),l=>(i(),p(z,{key:l.id,to:`/tasks/${l.id}`},{prepend:t(()=>[e(S,{color:Q(l.status),size:"small",class:"mr-2"},{default:t(()=>[o(r(W(l.status)),1)]),_:2},1032,["color"])]),append:t(()=>[e(S,{color:h(l.priority),size:"x-small",variant:"outlined",class:"mr-2"},{default:t(()=>[o(r(l.priority),1)]),_:2},1032,["color"]),e(d,{icon:"mdi-chevron-right"})]),default:t(()=>[e(E,null,{default:t(()=>[o(r(l.title),1)]),_:2},1024),e(F,null,{default:t(()=>[o(r(l.type.replace("_"," "))+" ",1),l.scheduledFor?(i(),y("span",me," Â· "+r(j(l.scheduledFor)),1)):A("",!0)]),_:2},1024)]),_:2},1032,["to"]))),128))]),_:1})):(i(),p(f,{key:2,class:"text-center text-medium-emphasis py-8"},{default:t(()=>[e(d,{icon:"mdi-clipboard-text-outline",size:"48",class:"mb-2"}),a[13]||(a[13]=m("div",null,"No tasks for this grave",-1)),e(x,{color:"primary",variant:"tonal",class:"mt-4",onClick:D},{default:t(()=>[...a[12]||(a[12]=[o(" Create First Task ",-1)])]),_:1})]),_:1}))]),_:1})],64)):(i(),p(ae,{key:2,type:"error",variant:"tonal"},{default:t(()=>[...a[14]||(a[14]=[o(" Grave not found ",-1)])]),_:1})),e(J,{modelValue:s(v),"onUpdate:modelValue":a[0]||(a[0]=l=>B(v)?v.value=l:null),grave:s(n),onSaved:s(U)},null,8,["modelValue","grave","onSaved"]),e(X,{modelValue:s(g),"onUpdate:modelValue":a[1]||(a[1]=l=>B(g)?g.value=l:null),"prefill-grave-id":s(T),onSaved:s(M)},null,8,["modelValue","prefill-grave-id","onSaved"])])}}});export{ye as default};
