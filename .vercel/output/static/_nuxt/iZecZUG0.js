import{d as S,ag as N,ah as T,r as i,k as h,ai as M,W as U,C as u,af as B,y as D,B as l,aj as F,D as f,M as E,_ as o,A as x,ak as P,al as $,am as j,Y as c,ad as q,an as A,$ as I,J as b,P as O,G as R}from"./CqnZqnHT.js";const G=S({__name:"CustomerDialog",props:N({customer:{}},{modelValue:{type:Boolean,default:!1},modelModifiers:{}}),emits:N(["saved"],["update:modelValue"]),setup(p,{emit:w}){const r=p,k=w,m=T(p,"modelValue"),V=i(),d=i(!1),n=h(()=>!!r.customer?.id),t=i({fullName:"",phone:"",email:"",notes:""}),v=R("showSnackbar");M(()=>r.customer,s=>{s?t.value={fullName:s.fullName,phone:s.phone||"",email:s.email||"",notes:s.notes||""}:C()},{immediate:!0});function C(){t.value={fullName:"",phone:"",email:"",notes:""}}function g(){m.value=!1,C()}async function y(){const{valid:s}=await V.value.validate();if(s){d.value=!0;try{const e=n.value?`/api/customers/${r.customer.id}`:"/api/customers",a=n.value?"PUT":"POST",_=await $fetch(e,{method:a,body:t.value});k("saved",_),v?.(`Customer ${n.value?"updated":"created"} successfully`),g()}catch(e){console.error("Error saving customer:",e),v?.("Failed to save customer","error")}finally{d.value=!1}}}return(s,e)=>(D(),U(B,{modelValue:m.value,"onUpdate:modelValue":e[4]||(e[4]=a=>m.value=a),"max-width":"500",persistent:""},{default:u(()=>[l(O,null,{default:u(()=>[l(F,{class:"d-flex align-center"},{default:u(()=>[l(E,{icon:o(n)?"mdi-pencil":"mdi-plus",class:"mr-2"},null,8,["icon"]),f(" "+x(o(n)?"Edit Customer":"New Customer"),1)]),_:1}),l(P,null,{default:u(()=>[l($,{ref_key:"formRef",ref:V,onSubmit:j(y,["prevent"])},{default:u(()=>[l(c,{modelValue:o(t).fullName,"onUpdate:modelValue":e[0]||(e[0]=a=>o(t).fullName=a),label:"Full Name",rules:[a=>!!a||"Name is required"],required:""},null,8,["modelValue","rules"]),l(c,{modelValue:o(t).phone,"onUpdate:modelValue":e[1]||(e[1]=a=>o(t).phone=a),label:"Phone",type:"tel"},null,8,["modelValue"]),l(c,{modelValue:o(t).email,"onUpdate:modelValue":e[2]||(e[2]=a=>o(t).email=a),label:"Email",type:"email",rules:[a=>!a||/.+@.+\..+/.test(a)||"Invalid email"]},null,8,["modelValue","rules"]),l(q,{modelValue:o(t).notes,"onUpdate:modelValue":e[3]||(e[3]=a=>o(t).notes=a),label:"Notes",rows:"3"},null,8,["modelValue"])]),_:1},512)]),_:1}),l(A,null,{default:u(()=>[l(I),l(b,{variant:"text",onClick:g},{default:u(()=>[...e[5]||(e[5]=[f("Cancel",-1)])]),_:1}),l(b,{color:"primary",loading:o(d),onClick:y},{default:u(()=>[f(x(o(n)?"Save":"Create"),1)]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),W=Object.assign(G,{__name:"CustomerDialog"});export{W as _};
